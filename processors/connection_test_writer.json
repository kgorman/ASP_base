{
    "name": "connection_test_writer",
    "pipeline": [
        {
            "$source": {
                "connectionName": "sample_stream_solar",
                "timeField": { "$dateFromString": { "dateString": "$timestamp" }}
            }
        },
        {
            "$limit": 10
        },
        {
            "$addFields": {
                "test_timestamp": "$$NOW",
                "test_id": { "$toString": "$_id" },
                "test_source": "connection_test",
                "original_data": "$$ROOT"
            }
        },
        {
            "$merge": {
                "into": {
                    "connectionName": "Cluster01",
                    "db": "test",
                    "coll": "connection_verification"
                },
                "whenNotMatched": "insert"
            }
        }
    ]
}
